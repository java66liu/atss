#!/bin/bash
source ${0%/*}/config.sh
echo 编译安装PHP 5.2.14所需的支持库

cd ${downloads}

rm libiconv-1.13.1/ -rf
tar zxvf libiconv-1.13.1.tar.gz
cd libiconv-1.13.1/
./configure --prefix=/usr/local # --build=i686-linux-gnu
make
make install
cd ../

rm libmcrypt-2.5.8/ -rf
tar zxvf libmcrypt-2.5.8.tar.gz 
cd libmcrypt-2.5.8/
./configure  # --build=i686-linux-gnu
make
make install
/sbin/ldconfig
cd libltdl/
./configure --enable-ltdl-install  # --host=i686
make
make install
cd ../../

rm mhash-0.9.9.9/ -rf
tar zxvf mhash-0.9.9.9.tar.gz
cd mhash-0.9.9.9/
./configure  # --build=i686-linux-gnu
make
make install
cd ../

ln -s /usr/local/lib/libmcrypt.la /usr/lib/libmcrypt.la
ln -s /usr/local/lib/libmcrypt.so /usr/lib/libmcrypt.so
ln -s /usr/local/lib/libmcrypt.so.4 /usr/lib/libmcrypt.so.4
ln -s /usr/local/lib/libmcrypt.so.4.4.8 /usr/lib/libmcrypt.so.4.4.8
ln -s /usr/local/lib/libmhash.a /usr/lib/libmhash.a
ln -s /usr/local/lib/libmhash.la /usr/lib/libmhash.la
ln -s /usr/local/lib/libmhash.so /usr/lib/libmhash.so
ln -s /usr/local/lib/libmhash.so.2 /usr/lib/libmhash.so.2
ln -s /usr/local/lib/libmhash.so.2.0.1 /usr/lib/libmhash.so.2.0.1
ln -s /usr/local/bin/libmcrypt-config /usr/bin/libmcrypt-config

rm mcrypt-2.6.8/ -rf
tar zxvf mcrypt-2.6.8.tar.gz
cd mcrypt-2.6.8/
/sbin/ldconfig
./configure  # --build=i686-linux-gnu
make
make install
cd ../
